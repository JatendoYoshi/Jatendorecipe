<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BoroBurgers - Local Order Manager</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial, sans-serif; background: #f8f9fa; margin: 20px; text-align: center; }
    .container { max-width: 600px; margin: auto; background: white; padding: 20px; box-shadow: 0 0 10px rgba(0,0,0,0.1); border-radius: 8px; }
    h2, h4 { color: #007bff; }
    input, button { margin: 5px; padding: 10px; font-size: 16px; border-radius: 5px; }
    input { width: calc(50% - 20px); border: 1px solid #ddd; }
    button { cursor: pointer; background: #007bff; color: white; border: none; }
    .autofill-buttons button { background: #28a745; }
    ul { list-style: none; padding: 0; text-align: left; }
    li { background: #ececec; margin: 5px 0; padding: 10px; display: flex; justify-content: space-between; border-radius: 5px; align-items: center; }
    .custom-autofill { margin: 15px 0; }
    .custom-autofill input { width: auto; }
    .price-section { margin-top: 20px; }
    .order-buttons button { margin-left: 5px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>BoroBurgers Order Manager (Local)</h2>
    <input id="orderInput" placeholder="Order Details">
    <input id="orderPrice" type="number" step="0.01" placeholder="Price (¬£)">
    <button onclick="submitOrder()">Submit Order</button>

    <div class="autofill-buttons">
      <h4>Quick Fill:</h4>
      <button onclick="autofill('The Classic')">The Classic</button>
      <button onclick="autofill('The Serbian Burger')">The Serbian Burger</button>
      <button onclick="autofill('The BigMak')">The BigMak</button>
      <button onclick="autofillWithMeal()">Meal + üçüü•§</button>
    </div>

    <div class="custom-autofill">
      <h4>Add Custom Autofill:</h4>
      <input id="customOrder" placeholder="Preset order">
      <button onclick="addCustom()">Add</button>
    </div>

    <ul id="orderList"></ul>

    <div class="price-section">
      <h4>Total: ¬£<span id="totalPrice">0.00</span></h4>
      <button onclick="applyReferral()">Apply 10% Discount</button>
      <button onclick="resetAll()" style="background:#dc3545;">Reset All</button>
    </div>
  </div>

  <script>
    let orders = JSON.parse(localStorage.getItem('orders')) || [];
    let nextID = parseInt(localStorage.getItem('nextID') || '1', 10);
    let editing = false, editingId = null;
    let referralApplied = localStorage.getItem('referral') === 'true';
    let customPresets = JSON.parse(localStorage.getItem('customPresets')) || [];

    function autofill(text){ document.getElementById('orderInput').value = text; }
    function autofillWithMeal(){
      let input = document.getElementById('orderInput');
      if (!input.value.trim()){ alert('Enter text first'); return; }
      input.value += ' + Meal üçüü•§';
    }
    function addCustom(){
      let txt = document.getElementById('customOrder').value.trim();
      if(!txt){ alert('Cannot be empty'); return; }
      customPresets.push(txt);
      localStorage.setItem('customPresets', JSON.stringify(customPresets));
      buildCustomButtons();
      document.getElementById('customOrder').value = '';
      buildCustomButtons();
    }
    function buildCustomButtons(){
      const div = document.querySelector('.autofill-buttons');
      // remove existing custom
      div.querySelectorAll('.autofill-custom').forEach(b=>b.remove());
      customPresets.forEach(txt => {
        let b = document.createElement('button');
        b.innerText = txt;
        b.classList.add('autofill-custom');
        b.style.background = '#ffc107';
        b.onclick = ()=>autofill(txt);
        div.appendChild(b);
      });
    }

    function saveOrders(){
      localStorage.setItem('orders', JSON.stringify(orders));
      localStorage.setItem('nextID', nextID);
    }

    function renderOrders(){
      const ul = document.getElementById('orderList');
      ul.innerHTML = '';
      orders.forEach(o => {
        let li = document.createElement('li');
        li.innerHTML = `#${o.id} - ${o.item} (¬£${o.price.toFixed(2)})`;
        let btns = document.createElement('span');
        btns.classList.add('order-buttons');
        let eB = document.createElement('button');
        eB.innerText='Edit'; eB.onclick=()=>startEdit(o.id);
        let dB = document.createElement('button');
        dB.innerText='Delete'; dB.onclick=()=>deleteOrder(o.id);
        btns.append(eB,dB);
        li.appendChild(btns);
        ul.appendChild(li);
      });
      let total = orders.reduce((s,o)=>s+o.price,0);
      if (referralApplied) total *= 0.9;
      document.getElementById('totalPrice').innerText = total.toFixed(2);
    }

    function deleteOrder(id){
      orders = orders.filter(o=>o.id!==id);
      saveOrders(); renderOrders();
    }

    function startEdit(id){
      let o = orders.find(x=>x.id===id);
      document.getElementById('orderInput').value = o.item;
      document.getElementById('orderPrice').value = o.price;
      editing = true; editingId = id;
    }

    function submitOrder(){
      let item = document.getElementById('orderInput').value.trim();
      let price = parseFloat(document.getElementById('orderPrice').value);
      if(!item||isNaN(price)||price<=0){ alert('Valid input needed'); return; }

      if(editing){
        let o = orders.find(x=>x.id===editingId);
        o.item = item; o.price = price;
        editing = false; editingId = null;
      } else {
        orders.push({ id: nextID++, item, price });
      }
      saveOrders(); renderOrders();
      document.getElementById('orderInput').value=''; document.getElementById('orderPrice').value='';
    }

    function applyReferral(){
      if(referralApplied){ alert('Already applied'); return; }
      referralApplied = true;
      localStorage.setItem('referral','true');
      renderOrders();
    }

    function resetAll(){
      if(!confirm('Delete ALL orders and presets?')) return;
      orders=[]; nextID=1; referralApplied=false; localStorage.clear();
      renderOrders(); buildCustomButtons();
    }

    window.onload = ()=>{
      buildCustomButtons();
      renderOrders();
    };
  </script>
</body>
</html>
